<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="description" content="">
		<meta name="author" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="mobile-web-app-capable" content="yes">

		<title>Runny (csharp)</title>
		<base target="_blank" href="../../">
		<link href="csharp-runny/site.css" rel="stylesheet" />
		<!-- <base href="/fiugd/plugins/.templates/csharp-runny/"> -->
	</head>

	// <script>
	// 	if(document.location.href.includes('/::preview::/')){
	// 		document.location.href = document.location.href.replace('/::preview::/', '');
	// 	}
	// </script>

	<body>
		<app></app>
		<textarea class="inputBox">{{template_input}}</textarea>
		<button class="runButton">Run</button>
		<textarea class="outputBox">Loading...</textarea>
	</body>

	<script>
		let isReady;
		const inputBox = document.querySelector('.inputBox');

		window.monacoInterop = {
			'editors': {},
			'initialize': () => {},
			'setCode': () => {},
			'getCode': (...args) => {
				if(!isReady){
					isReady = true;
					window.whenReady();
					return '';
				}
				const code = inputBox.value.trim();
				return code;
			}
		}

		window.whenReady = () => {
			const RunButton = document.querySelector('app button.btn');
			const runNew = document.querySelector('.runButton');
			runNew.onclick = () => RunButton.click();

			const OutputText = document.querySelector('app .content textarea:last-child');
			const outputNew = document.querySelector('.outputBox');
			Object.defineProperty(OutputText, 'value', {
					set: (value) => {
						outputNew.value = value;
					}
			});

			if(inputBox.value.trim()){
				RunButton.click();
			}
			console.log('DOT NET IS READY!!!');
		};
	</script>
	<script src="csharp-runny/_framework/blazor.webassembly.js"></script>
</html>